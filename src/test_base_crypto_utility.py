#/usr/bin/python
# -*- coding: utf-8 -*-
'''
Testa le operazioni della clase crypto_utility
'''
import sys
sys.path.append('/media/DATA/06-WorkSpace/netsec_wp/src/crypto')
import base_crypto_utility
import unittest
import struct



class TestKeyGeneration(unittest.TestCase):
	'''
	Casi di test per le operazioni definite nel modulo base_crypto_utility.py
	'''
	def testPrf(self):
		'''
		testo della funzione prf con il vettore 1 della rfc (pag 1128)
		'''
		key = struct.pack('20B',0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b)
		prefix = "prefix"
		data = "Hi There"
		length = 512/8
		prf = base_crypto_utility.prf(key,prefix,data,length)
		result = struct.pack('64B',0xbc,0xd4,0xc6,0x50,0xb3,0x0b,0x96,0x84,0x95,0x18,0x29,0xe0,0xd7,0x5f,0x9d,0x54,0xb8,0x62,0x17,0x5e,0xd9,0xf0,0x06,0x06,0xe1,0x7d,0x8d,0xa3,0x54,0x02,0xff,0xee,0x75,0xdf,0x78,0xc3,0xd3,0x1e,0x0f,0x88,0x9f,0x01,0x21,0x20,0xc0,0x86,0x2b,0xeb,0x67,0x75,0x3e,0x74,0x39,0xae,0x24,0x2e,0xdb,0x83,0x73,0x69,0x83,0x56,0xcf,0x5a)
		self.assertEqual(prf,result)
	


if __name__ == '__main__':
	suite = unittest.TestLoader().loadTestsFromTestCase(TestKeyGeneration)
	unittest.TextTestRunner(verbosity=2).run(suite)
